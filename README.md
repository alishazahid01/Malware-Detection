Malware Detection from Files and Directories Documentation
Introduction

This Python script is designed to detect the presence of malware in files and directories by comparing their content against a list of known malware signatures. The script can be used to scan individual files or entire directories for malware presence. This documentation provides an overview of the code structure, usage, and dependencies.
Getting Started

To use the Malware Detection script, follow these steps:

    Clone or download this repository to your local machine.

    Open the Python script in a code editor or integrated development environment (IDE).

    Configure the script by specifying the path to the file or directory you want to scan for malware.

    Define the malware signatures you want to check for by modifying the malware_signatures list.

    Run the script using the command:

    python malware_detection.py

    Follow the prompts to initiate malware detection.

Code Structure

The Malware Detection script consists of the following components:
1. Malware Detection Class


class MalwareDetection:
    
    # Constructor
    def __init__(self, location, malware_signatures):
        self.location = location
        self.malware_signatures = malware_signatures

This class is responsible for detecting malware in files and directories. It takes the location (file or directory path) and a list of malware signatures as input parameters.
2. File Detection


    # File Detection
    @print_message
    def file_detection(self):
        print("Scanning File.....")
        # Reading file
        with open(self.location, "rb") as file:
            content = file.read()
            # Checking malware signatures in the file
            for signature in self.malware_signatures:
                if signature in content:
                    return True
        return False

This method is used to scan individual files for malware. It reads the content of the file and checks it against the provided malware signatures.
3. Directory Detection

    # Directory Detection
    @print_message
    def dir_detection(self):
        print("Scanning Directory.....")
        # Checking each root, directories, and files in the path using os.walk()
        for root, dirs, files in os.walk(self.location):
            for file_name in files:
                # To get the absolute path of the file, we use os.path.join()
                file_path = os.path.join(root, file_name)
                # Reading file
                with open(file_path, "rb") as file:
                    content = file.read()
                    # Checking malware signatures in the file
                    for signature in self.malware_signatures:
                        if signature in content:
                            return True, file_path
        return False, None

This method is used to scan entire directories for malware. It uses os.walk() to iterate through all files and directories within the specified path. For each file, it reads the content and checks it against the provided malware signatures.
4. Main Execution


if __name__ == "__main__":

    # Load Signature of the Malware
    malware_signatures = [
        b'backdoor',
        b'trojan',
        b'keylogger'
    ]

    # Prompt user to enter the location of the file/directory
    location = input("Enter the path of the file/dir: ")

    # Create an object of the MalwareDetection class
    cls_obj = MalwareDetection(location, malware_signatures)

    # Check if the path is a file or directory
    if os.path.isfile(location):
        malware_file = cls_obj.file_detection()

        # Check the result
        if malware_file:
            print(f"Malware Found in file {location}")
        else:
            print(f"Congratulations! Malware not found in file {location}")

    elif os.path.isdir(location):
        malware_dir, file_path = cls_obj.dir_detection()

        # Check the result
        if malware_dir:
            print(f"Malware Found in file {file_path}")
        else:
            print(f"Congratulations! Malware not found in directory {location}")

    else:
        print("Path does not exist")

The main part of the script initializes the malware signatures, prompts the user to enter the file or directory path, and checks if the provided path exists. Depending on whether it's a file or directory, it calls the respective detection method and prints the result.
Usage

    Run the Python script to initiate the malware detection process:


    python malware_detection.py

    Enter the path of the file or directory when prompted. Ensure that you specify the correct path to the target file or directory.

    The script will scan the provided file or directory for malware signatures.

    If malware is detected, the script will display a message indicating the presence of malware along with the file or directory path.

    If no malware is detected, the script will display a message indicating the absence of malware.

    If the specified path does not exist, the script will display an error message.

Conclusion

This documentation provides an overview of the Malware Detection script, which allows you to scan files and directories for malware presence using predefined malware signatures. You can customize and use this script to perform malware detection on your files and directories for security purposes.
